
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../../assets/logo/grizzly_logo_16.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.6">
    
    
      
        <title>Anywhere - Grizzly</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.802231af.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#795649">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="brown" data-md-color-accent="deep-orange">
  
    
    <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#grizzlystepsutils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Grizzly" class="md-header__button md-logo" aria-label="Grizzly" data-md-component="logo">
      
  <img src="../../../assets/logo/grizzly_logo_128.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Grizzly
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Anywhere
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/biometria-se/grizzly/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Grizzly" class="md-nav__button md-logo" aria-label="Grizzly" data-md-component="logo">
      
  <img src="../../../assets/logo/grizzly_logo_128.png" alt="logo">

    </a>
    Grizzly
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/biometria-se/grizzly/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../example/" class="md-nav__link">
        Example
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../licenses/" class="md-nav__link">
        Licenses
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../../cli/" class="md-nav__link">
        Command Line Interface
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      <label class="md-nav__link" for="__nav_5">
        Usage
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Usage" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_1" type="checkbox" id="__nav_5_1" >
      
      <label class="md-nav__link" for="__nav_5_1">
        Variables
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Variables" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_1">
          <span class="md-nav__icon md-icon"></span>
          Variables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/environment-configuration/" class="md-nav__link">
        Environment configuration
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_1_2" type="checkbox" id="__nav_5_1_2" >
      
      <label class="md-nav__link" for="__nav_5_1_2">
        Testdata
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Testdata" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_1_2">
          <span class="md-nav__icon md-icon"></span>
          Testdata
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/testdata/csv-row/" class="md-nav__link">
        CSV Row
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/testdata/date/" class="md-nav__link">
        Date
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/testdata/directory-contents/" class="md-nav__link">
        Directory Contents
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/testdata/integer-incrementer/" class="md-nav__link">
        Integer incrementer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/testdata/random-integer/" class="md-nav__link">
        Random Integer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/testdata/random-string/" class="md-nav__link">
        Random String
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../variables/templating/" class="md-nav__link">
        Templating
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2" type="checkbox" id="__nav_5_2" checked>
      
      <label class="md-nav__link" for="__nav_5_2">
        Steps
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Steps" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_2">
          <span class="md-nav__icon md-icon"></span>
          Steps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2_1" type="checkbox" id="__nav_5_2_1" >
      
      <label class="md-nav__link" for="__nav_5_2_1">
        Background
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Background" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_2_1">
          <span class="md-nav__icon md-icon"></span>
          Background
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../background/setup/" class="md-nav__link">
        Setup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../background/shapes/" class="md-nav__link">
        Shapes
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_2_2" type="checkbox" id="__nav_5_2_2" >
      
      <label class="md-nav__link" for="__nav_5_2_2">
        Scenario
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Scenario" data-md-level="3">
        <label class="md-nav__title" for="__nav_5_2_2">
          <span class="md-nav__icon md-icon"></span>
          Scenario
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../scenario/user/" class="md-nav__link">
        User
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../scenario/setup/" class="md-nav__link">
        Setup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../scenario/tasks/" class="md-nav__link">
        Tasks
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../scenario/response/" class="md-nav__link">
        Response
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../scenario/results/" class="md-nav__link">
        Results
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Anywhere
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Anywhere
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step_utils_fail" class="md-nav__link">
    step_utils_fail
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_3" type="checkbox" id="__nav_5_3" >
      
      <label class="md-nav__link" for="__nav_5_3">
        Load Users
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Load Users" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_3">
          <span class="md-nav__icon md-icon"></span>
          Load Users
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../load-users/rest-api/" class="md-nav__link">
        Rest API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../load-users/message-queue/" class="md-nav__link">
        Message Queue
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../load-users/service-bus/" class="md-nav__link">
        Service Bus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../load-users/blob-storage/" class="md-nav__link">
        Blob Storage
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../load-users/secure-file-transfer-protocol/" class="md-nav__link">
        Secure File Transfer Protocol
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step_utils_fail" class="md-nav__link">
    step_utils_fail
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/biometria-se/grizzly/edit/master/docs/usage/steps/anywhere.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <p><a id="grizzly.steps.utils"></a></p>
<h1 id="grizzlystepsutils">grizzly.steps.utils</h1>
<p>This package contains steps that can be useful during development or troubleshooting of a
feature file, but should not be included in a finished, testable, feature.</p>
<p><a id="grizzly.steps.utils.step_utils_fail"></a></p>
<h4 id="step_utils_fail">step_utils_fail</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@then</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;fail&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_utils_fail</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Force a failed scenario. Can be useful when writing a new scenario.</p>
<div class="highlight"><pre><span></span><code><span class="k">Then </span><span class="nf">fail</span>
</code></pre></div>
<p><a id="grizzly.steps.setup"></a></p>
<h1 id="grizzlystepssetup">grizzly.steps.setup</h1>
<p><a id="grizzly.steps.setup.step_setup_variable_value_ask"></a></p>
<h4 id="step_setup_variable_value_ask">step_setup_variable_value_ask</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;ask for value of variable &quot;</span><span class="si">{name}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_setup_variable_value_ask</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>This step is used to indicate for <code>grizzly-cli</code> that it should ask for an initial value for the variable.
It will then inject the value into the locust runtime environment, and in this step read it and insert it
into the locust context which grizzly will use to setup locust.</p>
<p>If <code>grizzly-cli</code> is not used, one has to manually set the environment variable, which requires a prefix of
<code>TESTDATA_VARIABLE_</code> and the suffix should match the variable name in question.</p>
<p>Use this step for variables that should have different initial values for each run of the feature.</p>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">ask for value for variable &quot;</span><span class="s">AtomicIntegerIncrementer.messageID</span><span class="nf">&quot;</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>name</code> <em>str</em> - variable name used in templates</li>
</ul>
<p><a id="grizzly.steps.scenario"></a></p>
<h1 id="grizzlystepsscenario">grizzly.steps.scenario</h1>
<p>This package contains step implementations that only is allowed in the <code>Scenario</code> section in a feature file.</p>
<p><a id="grizzly.steps.scenario.user"></a></p>
<h1 id="grizzlystepsscenariouser">grizzly.steps.scenario.user</h1>
<p>This module contains step implementations that describes a user.</p>
<p><a id="grizzly.steps.scenario.user.step_user_type"></a></p>
<h4 id="step_user_type">step_user_type</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;a user of type &quot;</span><span class="si">{user_class_name}</span><span class="s1">&quot; load testing &quot;</span><span class="si">{host}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_user_type</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">user_class_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">host</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Set which type of user the scenario should use and which host is the target.</p>
<div class="highlight"><pre><span></span><code><span class="k">Given </span><span class="nf">a user of type &quot;</span><span class="s">RestApi</span><span class="nf">&quot; load testing &quot;</span><span class="s">http://api.google.com</span><span class="nf">&quot;</span>
<span class="k">Given </span><span class="nf">a user of type &quot;</span><span class="s">MessageQueue</span><span class="nf">&quot; load testing &quot;</span><span class="s">mq://mqm:secret@mq.example.com/?QueueManager=QMGR01&amp;Channel=Channel01</span><span class="nf">&quot;</span>
<span class="k">Given </span><span class="nf">a user of type &quot;</span><span class="s">ServiceBus</span><span class="nf">&quot; load testing &quot;</span><span class="s">sb://sb.example.com/;SharedAccessKeyName=RootManageSharedAccessKey;SharedAccessKey=abc123def456ghi789=</span><span class="nf">&quot;</span>
<span class="k">Given </span><span class="nf">a user of type &quot;</span><span class="s">BlobStorage</span><span class="nf">&quot; load testing &quot;</span><span class="s">DefaultEndpointsProtocol=https;EndpointSuffix=core.windows.net;AccountName=examplestorage;AccountKey=xxxyyyyzzz==</span><span class="nf">&quot;</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>user_class_name</code> <em>str</em> - name of an implementation in <code>grizzly.users</code>, with or without <code>User</code></li>
<li><code>host</code> <em>str</em> - an URL for the target host, format depends on which <code>user_class_name</code> (see <code>grizzly.users</code>)</li>
</ul>
<p><a id="grizzly.steps.scenario.response"></a></p>
<h1 id="grizzlystepsscenarioresponse">grizzly.steps.scenario.response</h1>
<p>This module contains step implementations that handles request responses.</p>
<p><a id="grizzly.steps.scenario.response.step_response_save_matches"></a></p>
<h4 id="step_response_save_matches">step_response_save_matches</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@then</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;save response {target:ResponseTarget} &quot;</span><span class="si">{expression}</span><span class="s1">&quot; that matches &quot;</span><span class="si">{match_with}</span><span class="s1">&quot; in variable &quot;</span><span class="si">{variable}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_response_save_matches</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">ResponseTarget</span><span class="p">,</span> <span class="n">expression</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">match_with</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">variable</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Save specified parts of a response, either from meta data (header) or payload (body), in a variable.</p>
<p>With this step it is possible to change variable values and as such use values from a response later on in the load test.</p>
<p>This step will fail if the specified <code>expression</code> has no match or more than one match.</p>
<div class="highlight"><pre><span></span><code><span class="c"># only token is matched and saved in TOKEN, by using regexp match groups</span><span class="nf"></span>
<span class="k">And </span><span class="nf">set variable &quot;</span><span class="s">TOKEN</span><span class="nf">&quot; to &quot;</span><span class="s">none</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">save response metadata &quot;</span><span class="s">$.Authentication</span><span class="nf">&quot; that matches &quot;</span><span class="s">Bearer (.*)$</span><span class="nf">&quot; in variabel &quot;</span><span class="s">TOKEN</span><span class="nf">&quot;</span>

<span class="c"># the whole value is saved, as long as Authentication starts with &quot;Bearer&quot;</span><span class="nf"></span>
<span class="k">And </span><span class="nf">set variable &quot;</span><span class="s">HEADER_AUTHENTICATION</span><span class="nf">&quot; to &quot;</span><span class="s">none</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">save response metadata &quot;</span><span class="s">$.Authentication</span><span class="nf">&quot; that matches &quot;</span><span class="s">^Bearer .*$</span><span class="nf">&quot; in variable &quot;</span><span class="s">HEADER_AUTHENTICATION</span><span class="nf">&quot;</span>

<span class="c"># only the numerical suffix is saved in the variable</span><span class="nf"></span>
<span class="k">And </span><span class="nf">set variable &quot;</span><span class="s">AtomicInteger.measurermentId</span><span class="nf">&quot; to &quot;</span><span class="s">0</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">save response payload &quot;</span><span class="s">$.measurement.id</span><span class="nf">&quot; that matches &quot;</span><span class="s">^cpu([\\d]+)$</span><span class="nf">&quot; in &quot;</span><span class="s">AtomicInteger.measurementId</span><span class="nf">&quot;</span>

<span class="c"># the whole value is saved, as long as the value starts with &quot;cpu&quot;</span><span class="nf"></span>
<span class="k">And </span><span class="nf">set variable &quot;</span><span class="s">measurementId</span><span class="nf">&quot; to &quot;</span><span class="s">0</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">save response payload &quot;</span><span class="s">$.measurement.id</span><span class="nf">&quot; that matches &quot;</span><span class="s">^cpu[\\d]+$</span><span class="nf">&quot; in &quot;</span><span class="s">measurementId</span><span class="nf">&quot;</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>target</code> <em>enum</em> - "metadata" or "payload", depending on which part of the response should be used</li>
<li><code>expression</code> <em>str</em> - JSON path expression for finding the property</li>
<li><code>match_with</code> <em>str</em> - static value or a regular expression</li>
<li><code>variable</code> <em>str</em> - name of the already initialized variable to save the value in</li>
</ul>
<p><a id="grizzly.steps.scenario.response.step_response_save"></a></p>
<h4 id="step_response_save">step_response_save</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@then</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;save response {target:ResponseTarget} &quot;</span><span class="si">{expression}</span><span class="s1">&quot; in variable &quot;</span><span class="si">{variable}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_response_save</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">ResponseTarget</span><span class="p">,</span> <span class="n">expression</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">variable</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Save metadata (header) or payload (body) value from a response in a variable.</p>
<p>This step is the same as <code>step_response_save_matches</code> if <code>match_with</code> is set to <code>.*</code>.</p>
<p>With this step it is possible to change variable values and as such use values from a response later on in the load test.</p>
<p>This step will fail if the specified <code>expression</code> has no match or more than one match.</p>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">save response metadata &quot;</span><span class="s">$.Authentication</span><span class="nf">&quot; in variable &quot;</span><span class="s">HEADER_AUTHENTICATION</span><span class="nf">&quot;</span>

<span class="k">And </span><span class="nf">save response payload &quot;</span><span class="s">$.MeasureResult.ShipmentId</span><span class="nf">&quot; in variable &quot;</span><span class="s">ShipmentId</span><span class="nf">&quot;</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>target</code> <em>enum</em> - "metadata" or "payload", depending on which part of the response should be used</li>
<li><code>expression</code> <em>str</em> - JSON path expression for finding the property</li>
<li><code>variable</code> <em>str</em> - name of the already initialized variable to save the value in</li>
</ul>
<p><a id="grizzly.steps.scenario.response.step_response_validate"></a></p>
<h4 id="step_response_validate">step_response_validate</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@when</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;response {target:ResponseTarget} &quot;</span><span class="si">{expression}</span><span class="s1">&quot; {condition:Condition} &quot;</span><span class="si">{match_with}</span><span class="s1">&quot; stop user&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_response_validate</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">ResponseTarget</span><span class="p">,</span> <span class="n">expression</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">condition</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">match_with</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Fails the scenario based on the value of a response meta data (header) or payload (body).</p>
<div class="highlight"><pre><span></span><code><span class="k">When </span><span class="nf">response metadata &quot;</span><span class="s">$.[&#39;content-type&#39;]</span><span class="nf">&quot; is not &quot;</span><span class="s">.*application/json.*</span><span class="nf">&quot; stop user</span>
<span class="k">When </span><span class="nf">response metadata &quot;</span><span class="s">$.[&#39;x-test-command&#39;]</span><span class="nf">&quot; is &quot;</span><span class="s">abort</span><span class="nf">&quot; stop user</span>
<span class="k">When </span><span class="nf">response metadata &quot;</span><span class="s">$.Authentication</span><span class="nf">&quot; is not &quot;</span><span class="s">Bearer .*$</span><span class="nf">&quot; stop user</span>

<span class="k">When </span><span class="nf">response payload &quot;</span><span class="s">$.measurement.id</span><span class="nf">&quot; is not &quot;</span><span class="s">cpu[0-9]+</span><span class="nf">&quot; stop user</span>
<span class="k">When </span><span class="nf">response payload &quot;</span><span class="s">$.success</span><span class="nf">&quot; is &quot;</span><span class="s">false</span><span class="nf">&quot; stop user</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>target</code> <em>enum</em> - "metadata" or "payload", depending on which part of the response should be used</li>
<li><code>expression</code> <em>str</em> - JSON path expression for finding the property</li>
<li><code>condition</code> <em>enum</em> - "is" or "is not" depending on negative or postive matching</li>
<li><code>match_with</code> <em>str</em> - static value or a regular expression</li>
</ul>
<p><a id="grizzly.steps.scenario.response.step_response_allow_status_codes"></a></p>
<h4 id="step_response_allow_status_codes">step_response_allow_status_codes</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@then</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;allow response status codes &quot;</span><span class="si">{status_list}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_response_allow_status_codes</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">status_list</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Set allowed response status codes for the latest defined request in the scenario.</p>
<p>By default <code>200</code> is the only allowed respoonse status code. By prefixing a code with minus (<code>-</code>),
it will be removed from the list of allowed response status codes.</p>
<div class="highlight"><pre><span></span><code><span class="k">Then </span><span class="nf">get request with name &quot;</span><span class="s">test-get-1</span><span class="nf">&quot; from endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">allow response status &quot;</span><span class="s">200,302</span><span class="nf">&quot;</span>

<span class="k">Then </span><span class="nf">get request with name &quot;</span><span class="s">test-failed-get-2</span><span class="nf">&quot; from endpoint &quot;</span><span class="s">/api/non-existing</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">allow response status &quot;</span><span class="s">-200,404</span><span class="nf">&quot;</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>status_list</code> <em>str</em> - comma separated list of integers</li>
</ul>
<p><a id="grizzly.steps.scenario.response.step_response_allow_status_codes_table"></a></p>
<h4 id="step_response_allow_status_codes_table">step_response_allow_status_codes_table</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@then</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;allow response status codes&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_response_allow_status_codes_table</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Set allowed response status codes for the latest defined requests based on a data table.</p>
<p>Specifies a comma separeated list of allowed return codes for the latest requests in a data table.</p>
<p>By default <code>200</code> is the only allowed respoonse status code. By prefixing a code with minus (<code>-</code>),
it will be removed from the list of allowed response status codes.</p>
<p>Number of rows in the table specifies which of the latest defined requests the allowed response
status codes should map to.</p>
<p>The table <strong>must</strong> have the column header <code>status</code>.</p>
<div class="highlight"><pre><span></span><code><span class="k">Then </span><span class="nf">get request with name &quot;</span><span class="s">test-get-1</span><span class="nf">&quot; from endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
<span class="k">Then </span><span class="nf">get request with name &quot;</span><span class="s">test-get-2</span><span class="nf">&quot; from endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">allow response status</span>
<span class="k"> |</span><span class="s"> status</span><span class="k">   |</span><span class="nf"></span>
<span class="k"> |</span><span class="s"> 200, 302</span><span class="k"> |</span><span class="nf"></span>
<span class="k"> |</span><span class="s"> 200,404</span><span class="k">  |</span>
</code></pre></div>
<p>Allowed response status codes for <code>test-get-1</code> is now <code>200</code> and <code>302</code>, and for <code>test-get-2</code> is
now <code>200</code> and <code>404</code>.</p>
<p><a id="grizzly.steps.scenario.response.step_response_content_type"></a></p>
<h4 id="step_response_content_type">step_response_content_type</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@then</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;set response content type to &quot;{content_type:ResponseContentType}&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_response_content_type</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">content_type</span><span class="p">:</span> <span class="n">ResponseContentType</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Set the content type of a response, instead of guessing it.</p>
<p>This is applicable when there is a <code>step_response_validate</code> or <code>step_response_save</code> is included in
the scenario, and is valid only for the latest defined request.</p>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">set response content type to &quot;</span><span class="s">json</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set response content type to &quot;</span><span class="s">application/json</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set response content type to &quot;</span><span class="s">xml</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set response content type to &quot;</span><span class="s">application/xml</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set response content type to &quot;</span><span class="s">plain</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set response content type to &quot;</span><span class="s">text/plain</span><span class="nf">&quot;</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>content_type</code> <em>ResponseContentType</em> - expected content type of response</li>
</ul>
<p><a id="grizzly.steps.scenario.setup"></a></p>
<h1 id="grizzlystepsscenariosetup">grizzly.steps.scenario.setup</h1>
<p>This module contains step implementations that setup the load test scenario with parameters that is going to be used in the scenario they are defined in.</p>
<p><a id="grizzly.steps.scenario.setup.step_setup_set_context_variable"></a></p>
<h4 id="step_setup_set_context_variable">step_setup_set_context_variable</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;set context variable &quot;</span><span class="si">{variable}</span><span class="s1">&quot; to &quot;</span><span class="si">{value}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_setup_set_context_variable</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">variable</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Set a variable in the scenario context.</p>
<p>Variable name can contain (one or more) dot (<code>.</code>) or slash (<code>/</code>) to indicate that the variable has a nested structure. E.g. <code>token.url</code>
and <code>token/url</code> results in:</p>
<p>It is also possible to have spaces in a variable name, they will then be replaced with underscore (<code>_</code>), and name will be
converted to lowercase.</p>
<p>E.g. <code>Client ID</code> results in <code>client_id</code></p>
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="err">&#39;</span><span class="kc">t</span><span class="err">oke</span><span class="kc">n</span><span class="err">&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="err">&#39;url&#39;</span><span class="p">:</span> <span class="err">&#39;&lt;value&gt;&#39;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">set context variable &quot;</span><span class="s">token.url</span><span class="nf">&quot; to &quot;</span><span class="s">https://example.com/api/auth</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set context variable &quot;</span><span class="s">token/client_id</span><span class="nf">&quot; to &quot;</span><span class="s">aaaa-bbbb-cccc-dddd</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set context variable &quot;</span><span class="s">token/client secret</span><span class="nf">&quot; to &quot;</span><span class="s">aasdfasdfasdf==</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set context variable &quot;</span><span class="s">token.resource</span><span class="nf">&quot; to &quot;</span><span class="s">0000-aaaaaaa-1111-1111-1111</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set context variable &quot;</span><span class="s">log_all_requests</span><span class="nf">&quot; to &quot;</span><span class="s">True</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set context variable &quot;</span><span class="s">validate_certificates</span><span class="nf">&quot; to &quot;</span><span class="s">False</span><span class="nf">&quot;</span>
</code></pre></div></p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>variable</code> <em>str</em> - name, can contain <code>.</code> and <code>/</code></li>
<li><code>value</code> <em>str</em> - value, data type will be guessed and casted</li>
</ul>
<p><a id="grizzly.steps.scenario.setup.step_setup_iterations"></a></p>
<h4 id="step_setup_iterations">step_setup_iterations</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;repeat for &quot;</span><span class="si">{value}</span><span class="s1">&quot; {iteration_number:IterationGramaticalNumber}&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_setup_iterations</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">iteration_number</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Set how many iterations of the requests in the scenario should execute.</p>
<p>Default value is <code>1</code>. A value of <code>0</code> means to run until all test data is consumed, or that the (optional) specified
runtime for the scenario is reached.</p>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">repeat for &quot;</span><span class="s">10</span><span class="nf">&quot; iterations</span>
<span class="k">And </span><span class="nf">repeat for &quot;</span><span class="s">1</span><span class="nf">&quot; iteration</span>
<span class="k">And </span><span class="nf">value for variable &quot;</span><span class="s">leveranser</span><span class="nf">&quot; is &quot;</span><span class="s">100</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">repeat for &quot;</span><span class="s">{{ leveranser * 0.25 }}</span><span class="nf">&quot; iterations</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>iterations</code> <em>int</em> - number of iterations of the scenario</li>
</ul>
<p><a id="grizzly.steps.scenario.setup.step_setup_wait_time"></a></p>
<h4 id="step_setup_wait_time">step_setup_wait_time</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;wait time inbetween requests is random between &quot;</span><span class="si">{minimum:f}</span><span class="s1">&quot; and &quot;</span><span class="si">{maximum:f}</span><span class="s1">&quot; seconds&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_setup_wait_time</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">minimum</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">maximum</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Set how long (seconds) locust should wait between tasks.</p>
<p>Default value is <code>1.0</code> seconds. Set <code>wait_min = wait_max</code> if the wait shouldn't be random in the
specified interval.</p>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">wait time inbetween requests is random between &quot;</span><span class="s">0.3</span><span class="nf">&quot; and &quot;</span><span class="s">0.5</span><span class="nf">&quot; seconds</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>wait_min</code> <em>float</em> - minimum wait time</li>
<li><code>wait_max</code> <em>float</em> - maximum wait time</li>
</ul>
<p><a id="grizzly.steps.scenario.setup.step_setup_variable_value"></a></p>
<h4 id="step_setup_variable_value">step_setup_variable_value</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;value for variable &quot;</span><span class="si">{name}</span><span class="s1">&quot; is &quot;</span><span class="si">{value}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_setup_variable_value</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Initialize a variable.</p>
<p>Use this step to initialize a variable that should have the same [start] value for every run of
the scenario.</p>
<p>Data type for the value of the variable is based on the type of variable. If the variable is an "<code>Atomic*</code>"-variable
then the value needs to match the format and type that the variable has implemented. If it is a non "<code>Atomic*</code>"-variable
<code>grizzly</code> will try to guess the data type. E.g.:
* <code>"10"</code> becomes <code>int</code>
* <code>"1.0"</code> becomes <code>float</code>
* <code>"True"</code> becomes <code>bool</code>
* everything else becomes <code>str</code></p>
<p>It is possible to set the value of a variable based on another variable, which can be usable if you have a variable in
multiple scenarios which all should have the same initial value.</p>
<p><div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">value for variable &quot;</span><span class="s">HelloWorld</span><span class="nf">&quot; is &quot;</span><span class="s">default</span><span class="nf">&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">Feature:</span><span class="nf"></span>
<span class="nf">    </span><span class="k">Background:</span><span class="nf"></span>
<span class="k">        And </span><span class="nf">ask for value of variable &quot;</span><span class="s">messageID</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">Scenario:</span><span class="nf"></span>
<span class="k">        And </span><span class="nf">value for variable &quot;</span><span class="s">AtomicIntegerIncrementer.mid1</span><span class="nf">&quot; is &quot;</span><span class="s">{{ messageID }}</span><span class="nf">&quot;</span>
</code></pre></div></p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>name</code> <em>str</em> - variable name</li>
<li><code>value</code> <em>Any</em> - initial value</li>
</ul>
<p><a id="grizzly.steps.scenario.setup.step_setup_set_variable_alias"></a></p>
<h4 id="step_setup_set_variable_alias">step_setup_set_variable_alias</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;set alias &quot;</span><span class="si">{alias}</span><span class="s1">&quot; for variable &quot;</span><span class="si">{variable}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_setup_set_variable_alias</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">variable</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Create an alias for a variable that points to another structure in the context.</p>
<p>This is useful if you have test data that somehow should change the behavior for a
user, e.g. username and password.</p>
<p>Assumed that the file <code>users.csv</code> contains the columns <code>username</code> and <code>password</code>; without
the alias step it would look like the following structure in the context:</p>
<p>With the alias step it will be transformed to this:</p>
<p>Variables in payload templates are not allowed to have an alias.</p>
<p><div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">set variable &quot;</span><span class="s">AtomicCsvRow.users</span><span class="nf">&quot; to &quot;</span><span class="s">users.csv | repeat=True</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set alias &quot;</span><span class="s">auth.user.username</span><span class="nf">&quot; for variable &quot;</span><span class="s">AtomicCsvRow.users.username</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set alias &quot;</span><span class="s">auth.user.password</span><span class="nf">&quot; for variable &quot;</span><span class="s">AtomicCsvRow.users.password</span><span class="nf">&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;variables&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;AtomicCsvRow&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;users&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;username&quot;</span><span class="p">,</span>
                <span class="nt">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;password&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="nt">&quot;auth&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;username&quot;</span><span class="p">:</span> <span class="s2">&quot;username&quot;</span><span class="p">,</span>
            <span class="nt">&quot;password&quot;</span><span class="p">:</span> <span class="s2">&quot;password&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>alias</code> <em>str</em> - which node in the context that should get the value of <code>variable</code></li>
<li><code>variable</code> <em>str</em> - an already initialized variable that should be renamed</li>
</ul>
<p><a id="grizzly.steps.scenario.setup.step_setup_log_all_requests"></a></p>
<h4 id="step_setup_log_all_requests">step_setup_log_all_requests</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;log all requests&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_setup_log_all_requests</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Set if all requests should be logged to a file.</p>
<p>By default only failed requests (and responses) will be logged.</p>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">log all requests</span>
</code></pre></div>
<p><a id="grizzly.steps.scenario.setup.step_setup_enable_stop_on_failure"></a></p>
<h4 id="step_setup_enable_stop_on_failure">step_setup_enable_stop_on_failure</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;stop on first failure&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_setup_enable_stop_on_failure</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Stop a scenario at first failed request.</p>
<p>Default behavior is to continue the scenario if a request fails.</p>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">stop on first failure</span>
</code></pre></div>
<p><a id="grizzly.steps.scenario.results"></a></p>
<h1 id="grizzlystepsscenarioresults">grizzly.steps.scenario.results</h1>
<p>This module contains step implementations that validates the response results for all requests in a scenario.</p>
<p><a id="grizzly.steps.scenario.results.step_results_fail_ratio"></a></p>
<h4 id="step_results_fail_ratio">step_results_fail_ratio</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@when</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;fail ratio is greater than &quot;</span><span class="si">{fail_ratio:d}</span><span class="s1">&quot;</span><span class="si">% f</span><span class="s1">ail scenario&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_results_fail_ratio</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">fail_ratio</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Set how many percentages of requests that are allowed to fail before the whole scenario will be set as failed.</p>
<p>This step cannot be used in combination with <code>step_setup_enable_stop_on_failure</code>.</p>
<p>Default behavior is not to validate the result for a scenario based on failed requests.</p>
<div class="highlight"><pre><span></span><code><span class="k">When </span><span class="nf">fail ratio is greater than &quot;</span><span class="s">8</span><span class="nf">&quot;% fail scenario</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>fail_ratio</code> <em>int</em> - percentage of requests that are allowed to fail</li>
</ul>
<p><a id="grizzly.steps.scenario.results.step_results_avg_response_time"></a></p>
<h4 id="step_results_avg_response_time">step_results_avg_response_time</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@when</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;average response time is greater than &quot;</span><span class="si">{avg_response_time:d}</span><span class="s1">&quot; milliseconds fail scenario&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_results_avg_response_time</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">avg_response_time</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Set the average response time (milliseconds) that all requests in a scenario must be below
for it to pass.</p>
<p>Default behavior is not to validate the result for a scenario based on average response time.</p>
<div class="highlight"><pre><span></span><code><span class="k">When </span><span class="nf">average response time is greater than &quot;</span><span class="s">200</span><span class="nf">&quot; milliseconds fail scenario</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>avg_response_time</code> <em>int</em> - allowed average response time in milliseconds</li>
</ul>
<p><a id="grizzly.steps.scenario.results.step_results_response_time_percentile"></a></p>
<h4 id="step_results_response_time_percentile">step_results_response_time_percentile</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@when</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;response time percentile &quot;</span><span class="si">{percentile:d}</span><span class="s1">&quot;</span><span class="si">% i</span><span class="s1">s greater than &quot;</span><span class="si">{response_time:d}</span><span class="s1">&quot; milliseconds fail scenario&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_results_response_time_percentile</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">percentile</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">response_time</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Set the response time that a specified percentile of the requests needs to be below for the scenario to pass.</p>
<p>Default behavior is not to validate the result for a scenario based on percetile response times.</p>
<div class="highlight"><pre><span></span><code><span class="k">When </span><span class="nf">response time percentile &quot;</span><span class="s">95</span><span class="nf">&quot;% is greater than &quot;</span><span class="s">200</span><span class="nf">&quot; milliseconds fail scenario</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>percentile</code> <em>int</em> - percentile to validate (1-100)</li>
<li><code>response_time</code> <em>int</em> - response time in milliseconds</li>
</ul>
<p><a id="grizzly.steps.scenario.tasks"></a></p>
<h1 id="grizzlystepsscenariotasks">grizzly.steps.scenario.tasks</h1>
<p>This module contains step implementations that describes requests sent by <code>user_class_name</code> targeting <code>host</code>.</p>
<p><a id="grizzly.steps.scenario.tasks.step_task_request_text_with_name_to_endpoint"></a></p>
<h4 id="step_task_request_text_with_name_to_endpoint">step_task_request_text_with_name_to_endpoint</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@then</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;{method:Method} request with name &quot;</span><span class="si">{name}</span><span class="s1">&quot; {direction:Direction} endpoint &quot;</span><span class="si">{endpoint}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_task_request_text_with_name_to_endpoint</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="n">RequestMethod</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">direction</span><span class="p">:</span> <span class="n">RequestDirection</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Creates a named request to an endpoint on <code>host</code>, where optional payload is defined directly in the feature file.</p>
<p>If <code>method</code> in the expression is <code>get</code> or <code>receive</code>; the <code>direction</code> <strong>must</strong> be <code>from</code>.
If <code>method</code> in the expression is <code>post</code>, <code>pust</code>, or <code>send</code>; the <code>direction</code> <strong>must</strong> be <code>to</code>, and payload defined in the feature file.</p>
<div class="highlight"><pre><span></span><code><span class="k">Then </span><span class="nf">post request with name &quot;</span><span class="s">test-post</span><span class="nf">&quot; to endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">&quot;&quot;&quot;</span><span class="s"></span>
<span class="s">    {</span>
<span class="s">        &quot;test&quot;: &quot;hello world&quot;</span>
<span class="s">    }</span>
<span class="s">    </span><span class="k">&quot;&quot;&quot;</span><span class="nf"></span>
<span class="k">Then </span><span class="nf">put request with name &quot;</span><span class="s">test-post</span><span class="nf">&quot; to endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">&quot;&quot;&quot;</span><span class="s"></span>
<span class="s">    {</span>
<span class="s">        &quot;test&quot;: &quot;hello world&quot;</span>
<span class="s">    }</span>
<span class="s">    </span><span class="k">&quot;&quot;&quot;</span><span class="nf"></span>
<span class="k">Then </span><span class="nf">get request with name &quot;</span><span class="s">test-get</span><span class="nf">&quot; from endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>

<span class="k">Then </span><span class="nf">send request with name &quot;</span><span class="s">test-send</span><span class="nf">&quot; to endpoint &quot;</span><span class="s">receive-queue</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">&quot;&quot;&quot;</span><span class="s"></span>
<span class="s">    {</span>
<span class="s">        &quot;value&quot;: &quot;do something&quot;</span>
<span class="s">    }</span>
<span class="s">    </span><span class="k">&quot;&quot;&quot;</span><span class="nf"></span>
<span class="k">Then </span><span class="nf">receive request with name &quot;</span><span class="s">test-receive</span><span class="nf">&quot; from endpoint &quot;</span><span class="s">receive-queue</span><span class="nf">&quot;</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>method</code> <em>RequestMethod</em> - type of request</li>
<li><code>name</code> <em>str</em> - name of the requests in logs, can contain variables</li>
<li><code>direction</code> <em>RequestDirection</em> - one of <code>to</code> or <code>from</code> depending on the value of <code>method</code></li>
<li><code>endpoint</code> <em>str</em> - URI relative to <code>host</code> in the scenario, can contain variables and in certain cases <code>user_class_name</code> specific parameters</li>
</ul>
<p><a id="grizzly.steps.scenario.tasks.step_task_request_file_with_name_endpoint"></a></p>
<h4 id="step_task_request_file_with_name_endpoint">step_task_request_file_with_name_endpoint</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@then</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;{method:Method} request &quot;</span><span class="si">{source}</span><span class="s1">&quot; with name &quot;</span><span class="si">{name}</span><span class="s1">&quot; to endpoint &quot;</span><span class="si">{endpoint}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_task_request_file_with_name_endpoint</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="n">RequestMethod</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">endpoint</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Creates a named request to an endpoint on <code>host</code>, where the payload is defined in a template file.</p>
<div class="highlight"><pre><span></span><code><span class="k">Then </span><span class="nf">send request &quot;</span><span class="s">test/request.j2.json</span><span class="nf">&quot; with name &quot;</span><span class="s">test-send</span><span class="nf">&quot; to endpoint &quot;</span><span class="s">receive-queue</span><span class="nf">&quot;</span>
<span class="k">Then </span><span class="nf">post request &quot;</span><span class="s">test/request.j2.json</span><span class="nf">&quot; with name &quot;</span><span class="s">test-post</span><span class="nf">&quot; to endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
<span class="k">Then </span><span class="nf">put request &quot;</span><span class="s">test/request.j2.json</span><span class="nf">&quot; with name &quot;</span><span class="s">test-put</span><span class="nf">&quot; to endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>method</code> <em>RequestMethod</em> - type of request</li>
<li><code>source</code> <em>str</em> - path to a template file relative to the directory <code>requests/</code>, which <strong>must</strong> exist in the directory the feature file is located</li>
<li><code>name</code> <em>str</em> - name of the requests in logs, can contain variables</li>
<li><code>endpoint</code> <em>str</em> - URI relative to <code>host</code> in the scenario, can contain variables and in certain cases <code>user_class_name</code> specific parameters</li>
</ul>
<p><a id="grizzly.steps.scenario.tasks.step_task_request_file_with_name"></a></p>
<h4 id="step_task_request_file_with_name">step_task_request_file_with_name</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@then</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;{method:Method} request &quot;</span><span class="si">{source}</span><span class="s1">&quot; with name &quot;</span><span class="si">{name}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_task_request_file_with_name</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="n">RequestMethod</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Creates a named request to the same endpoint as previous request, where the payload is defined in a template file.</p>
<div class="highlight"><pre><span></span><code><span class="k">Then </span><span class="nf">post request &quot;</span><span class="s">test/request1.j2.json</span><span class="nf">&quot; with name &quot;</span><span class="s">test-post1</span><span class="nf">&quot; to endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
<span class="k">Then </span><span class="nf">post request &quot;</span><span class="s">test/request2.j2.json</span><span class="nf">&quot; with name &quot;</span><span class="s">test-post2</span><span class="nf">&quot;</span>

<span class="c"># same as</span><span class="nf"></span>
<span class="k">Then </span><span class="nf">post request &quot;</span><span class="s">test/request1.j2.json</span><span class="nf">&quot; with name &quot;</span><span class="s">test-post1</span><span class="nf">&quot; to endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
<span class="k">Then </span><span class="nf">post request &quot;</span><span class="s">test/request2.j2.json</span><span class="nf">&quot; with name &quot;</span><span class="s">test-post2</span><span class="nf">&quot; to endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>method</code> <em>RequestMethod</em> - type of request</li>
<li><code>source</code> <em>str</em> - path to a template file relative to the directory <code>requests/</code>, which <strong>must</strong> exist in the directory the feature file is located</li>
<li><code>name</code> <em>str</em> - name of the requests in logs, can contain variables</li>
</ul>
<p><a id="grizzly.steps.scenario.tasks.step_task_request_text_with_name"></a></p>
<h4 id="step_task_request_text_with_name">step_task_request_text_with_name</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@then</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;{method:Method} request with name &quot;</span><span class="si">{name}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_task_request_text_with_name</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="n">RequestMethod</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Creates a named request to the same endpoint as previous request, where optional payload is defined directly in the feature file.</p>
<p>If <code>method</code> in the expression is <code>post</code>, <code>put</code> or <code>send</code> the payload in the request <strong>must</strong> be defined directly in the feature file after the step.
This step is useful if <code>method</code> and <code>endpoint</code> are the same as previous request, but the payload should be different.</p>
<div class="highlight"><pre><span></span><code><span class="k">Then </span><span class="nf">post request with name &quot;</span><span class="s">test-post-1</span><span class="nf">&quot; to endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">&quot;&quot;&quot;</span><span class="s"></span>
<span class="s">    {</span>
<span class="s">        &quot;value&quot;: &quot;hello world!&quot;</span>
<span class="s">    }</span>
<span class="s">    </span><span class="k">&quot;&quot;&quot;</span><span class="nf"></span>
<span class="k">Then </span><span class="nf">post request with name &quot;</span><span class="s">test-post-2</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">&quot;&quot;&quot;</span><span class="s"></span>
<span class="s">    {</span>
<span class="s">        &quot;value&quot;: &quot;i have good news!&quot;</span>
<span class="s">    }</span>
<span class="s">    </span><span class="k">&quot;&quot;&quot;</span><span class="nf"></span>

<span class="c"># same as</span><span class="nf"></span>
<span class="k">Then </span><span class="nf">post request with name &quot;</span><span class="s">test-post-1</span><span class="nf">&quot; to endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">&quot;&quot;&quot;</span><span class="s"></span>
<span class="s">    {</span>
<span class="s">        &quot;value&quot;: &quot;hello world!&quot;</span>
<span class="s">    }</span>
<span class="s">    </span><span class="k">&quot;&quot;&quot;</span><span class="nf"></span>
<span class="k">Then </span><span class="nf">post request with name &quot;</span><span class="s">test-post-2</span><span class="nf">&quot; to endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
<span class="nf">    </span><span class="k">&quot;&quot;&quot;</span><span class="s"></span>
<span class="s">    {</span>
<span class="s">        &quot;value&quot;: &quot;i have good news!&quot;</span>
<span class="s">    }</span>
<span class="s">    </span><span class="k">&quot;&quot;&quot;</span><span class="nf"></span>

<span class="k">Then </span><span class="nf">get request with name &quot;</span><span class="s">test-get-1</span><span class="nf">&quot; from endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
<span class="k">Then </span><span class="nf">get request with name &quot;</span><span class="s">test-get-2</span><span class="nf">&quot;</span>

<span class="c"># same as</span><span class="nf"></span>
<span class="k">Then </span><span class="nf">get request with name &quot;</span><span class="s">test-get-1</span><span class="nf">&quot; from endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
<span class="k">Then </span><span class="nf">get request with name &quot;</span><span class="s">test-get-2</span><span class="nf">&quot; from endpoint &quot;</span><span class="s">/api/test</span><span class="nf">&quot;</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>method</code> <em>RequestMethod</em> - type of request</li>
<li><code>name</code> <em>str</em> - name of the requests in logs, can contain variables</li>
</ul>
<p><a id="grizzly.steps.scenario.tasks.step_task_wait_seconds"></a></p>
<h4 id="step_task_wait_seconds">step_task_wait_seconds</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@then</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;wait for &quot;</span><span class="si">{wait_time:f}</span><span class="s1">&quot; seconds&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_task_wait_seconds</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">wait_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Create an explicit wait (task) in the scenario. The scenario will wait the time specified (seconds) on top
of what has been defined in <code>step_setup_wait_time</code>.</p>
<p>Above combinations of steps will result in a wait time between 3 and 4 seconds for the first request that is defined after the
<code>And wait for...</code>-step.</p>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">wait time inbetween requests is random between &quot;</span><span class="s">1.5</span><span class="nf">&quot; and &quot;</span><span class="s">2.5</span><span class="nf">&quot; seconds</span>
<span class="nf">...</span>
<span class="k">And </span><span class="nf">wait for &quot;</span><span class="s">1.5</span><span class="nf">&quot; seconds</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>wait_time</code> <em>float</em> - wait time in seconds</li>
</ul>
<p><a id="grizzly.steps.background"></a></p>
<h1 id="grizzlystepsbackground">grizzly.steps.background</h1>
<p>This package contains step implementations that only is allowed in the <code>Background</code> section in a <code>Feature</code>.
The feature will fail if they are added into any other section.</p>
<p><a id="grizzly.steps.background.setup"></a></p>
<h1 id="grizzlystepsbackgroundsetup">grizzly.steps.background.setup</h1>
<p>This module contains step implementations that configures the load test scenario with parameters applicable for all scenarios.</p>
<p><a id="grizzly.steps.background.setup.step_setup_save_statistics"></a></p>
<h4 id="step_setup_save_statistics">step_setup_save_statistics</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;save statistics to &quot;</span><span class="si">{url}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_setup_save_statistics</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Sets an URL where locust statistics should be sent.</p>
<p>It has support for InfluxDB and Azure Application Insights endpoints.</p>
<p>For InfluxDB the following format <strong>must</strong> be used:</p>
<p>For Azure Application Insights the following format <strong>must</strong> be used:</p>
<p><div class="highlight"><pre><span></span><code>influxdb://[&lt;username&gt;:&lt;password&gt;@]&lt;hostname&gt;[:&lt;port&gt;]/&lt;database&gt;?TargetEnviroment=&lt;target environment&gt;[&amp;Testplan=&lt;test plan&gt;]
[&amp;TargetEnvironment=&lt;target environment&gt;][&amp;ProfileName=&lt;profile name&gt;][&amp;Description=&lt;description&gt;]
</code></pre></div>
<div class="highlight"><pre><span></span><code>insights://?InstrumentationKey=&lt;instrumentation key&gt;&amp;IngestionEndpoint=&lt;ingestion endpoint&gt;[&amp;Testplan=&lt;test plan&gt;]
insights://&lt;ingestion endpoint&gt;/?InstrumentationKey=&lt;instrumentation key&gt;[&amp;Testplan=&lt;test plan&gt;]
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">save statistics to &quot;</span><span class="s">influxdb://grizzly:secret-password@influx.example.com/grizzly-statistics</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">save statistics to &quot;</span><span class="s">insights://?IngestionEndpoint=https://insights.example.com&amp;Testplan=grizzly-statistics&amp;InstrumentationKey=asdfasdfasdf=</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">save statistics to &quot;</span><span class="s">insights://insights.example.com/?Testplan=grizzly-statistics&amp;InstrumentationKey=asdfasdfasdf=</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">save statistics to &quot;</span><span class="s">influxdb://$conf::statistics.username:$conf::statistics.password@influx.example.com/$conf::statistics.database</span><span class="nf">&quot;</span>
</code></pre></div></p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>url</code> <em>str</em> - URL for statistics endpoint</li>
</ul>
<p><a id="grizzly.steps.background.setup.step_setup_log_level"></a></p>
<h4 id="step_setup_log_level">step_setup_log_level</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;log level is &quot;</span><span class="si">{log_level}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_setup_log_level</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">log_level</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Configure log level for <code>grizzly</code>.</p>
<p>Default value is <code>INFO</code>, by changing to <code>DEBUG</code> there is more information what <code>grizzly</code> is doing behind the curtains.</p>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">log level is &quot;</span><span class="s">DEBUG</span><span class="nf">&quot;</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>log_level</code> <em>str</em> - allowed values <code>INFO</code>, <code>DEBUG</code>, <code>WARNING</code> och <code>ERROR</code></li>
</ul>
<p><a id="grizzly.steps.background.setup.step_setup_run_time"></a></p>
<h4 id="step_setup_run_time">step_setup_run_time</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;run for maximum &quot;</span><span class="si">{timespan}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_setup_run_time</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">timespan</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Configures the time period a headless test should run for.
If available test data is infinite, the test will run forever if this step is not used.</p>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">run for maximum &quot;</span><span class="s">1h</span><span class="nf">&quot;</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>timespan</code> <em>str</em> - description of how long the test should run for, e.g. 10s, 1h, 40m etc.</li>
</ul>
<p><a id="grizzly.steps.background.setup.step_setup_set_global_context_variable"></a></p>
<h4 id="step_setup_set_global_context_variable">step_setup_set_global_context_variable</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;set global context variable &quot;</span><span class="si">{variable}</span><span class="s1">&quot; to &quot;</span><span class="si">{value}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_setup_set_global_context_variable</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">variable</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Create a global variable in the context. Depending on which type of user a scenario is configured for, different variables
are available. Check <code>grizzly.users</code> documentation for which context variables are available for each user.</p>
<p>This step can be used if the feature file has multiple scenarios and all of them have the same context variables.</p>
<p>Variable names can contain (one ore more) dot (<code>.</code>) or slash (<code>/</code>) to indicate that the variable is in a structure. All names will also be
converted to lower case.</p>
<p>E.g. <code>token.url</code> and <code>token/URL</code> results in:</p>
<p>Space in variable names is also allowed and will then be translated to an underscore (<code>_</code>)</p>
<p>E.g. <code>Client ID</code> results in <code>client_id</code>.</p>
<p>Data type of values will be guessed, if not explicitly specified by the type of variable used (<code>Atomic*</code>). E.g. the last two
examples above will result in:</p>
<p><div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="err">&#39;</span><span class="kc">t</span><span class="err">oke</span><span class="kc">n</span><span class="err">&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="err">&#39;url&#39;</span><span class="p">:</span> <span class="err">&#39;&lt;value&gt;&#39;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">set global context variable &quot;</span><span class="s">token.url</span><span class="nf">&quot; to &quot;</span><span class="s">http://test.nu/api/auth</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set global context variable &quot;</span><span class="s">token/client_id</span><span class="nf">&quot; to &quot;</span><span class="s">aaaa-bbbb-cccc-dddd</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set global context variable &quot;</span><span class="s">token/client secret</span><span class="nf">&quot; to &quot;</span><span class="s">aasdfasdfasdf==</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set global context variable &quot;</span><span class="s">token.resource</span><span class="nf">&quot; to &quot;</span><span class="s">0000-aaaaaaa-1111-1111-1111</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set global context variable &quot;</span><span class="s">log_all_requests</span><span class="nf">&quot; to &quot;</span><span class="s">True</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set global context variable &quot;</span><span class="s">validate_certificates</span><span class="nf">&quot; to &quot;</span><span class="s">False</span><span class="nf">&quot;</span>
<span class="k">And </span><span class="nf">set global context variable &quot;</span><span class="s">run_id</span><span class="nf">&quot; to &quot;</span><span class="s">13</span><span class="nf">&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
    <span class="err">&#39;valida</span><span class="kc">te</span><span class="err">_cer</span><span class="kc">t</span><span class="err">i</span><span class="kc">f</span><span class="err">ica</span><span class="kc">tes</span><span class="err">&#39;</span><span class="p">:</span> <span class="err">False</span><span class="p">,</span>
    <span class="err">&#39;ru</span><span class="kc">n</span><span class="err">_id&#39;</span><span class="p">:</span> <span class="mi">13</span>
<span class="p">}</span>
</code></pre></div></p>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>variable</code> <em>str</em> - variable name, as used in templates</li>
<li><code>value</code> <em>str</em> - variable value</li>
</ul>
<p><a id="grizzly.steps.background.shapes"></a></p>
<h1 id="grizzlystepsbackgroundshapes">grizzly.steps.background.shapes</h1>
<p>This module contains step implementations that describes the actual load all scenarios in a feature will generate.</p>
<p><a id="grizzly.steps.background.shapes.step_shapes_user_count"></a></p>
<h4 id="step_shapes_user_count">step_shapes_user_count</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;&quot;</span><span class="si">{user_count:d}</span><span class="s1">&quot; {user_number:UserGramaticalNumber}&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_shapes_user_count</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">user_count</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">user_number</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Set number of users that will generate load.</p>
<div class="highlight"><pre><span></span><code><span class="k">Given </span><span class="nf">&quot;</span><span class="s">5</span><span class="nf">&quot; users</span>
<span class="k">Given </span><span class="nf">&quot;</span><span class="s">1</span><span class="nf">&quot; user</span>
<span class="k">Given </span><span class="nf">&quot;</span><span class="s">$conf::load.user.count</span><span class="nf">&quot;</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>user_count</code> <em>int</em> - Number of users locust should create</li>
</ul>
<p><a id="grizzly.steps.background.shapes.step_shapes_spawn_rate"></a></p>
<h4 id="step_shapes_spawn_rate">step_shapes_spawn_rate</h4>
<div class="highlight"><pre><span></span><code><span class="nd">@given</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;spawn rate is &quot;</span><span class="si">{spawn_rate:d}</span><span class="s1">&quot; {user_number:UserGramaticalNumber} per second&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">step_shapes_spawn_rate</span><span class="p">(</span><span class="n">context</span><span class="p">:</span> <span class="n">Context</span><span class="p">,</span> <span class="n">spawn_rate</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">user_number</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>
<p>Set rate in which locust shall swarm new user instances.</p>
<div class="highlight"><pre><span></span><code><span class="k">And </span><span class="nf">spawn rate is &quot;</span><span class="s">5</span><span class="nf">&quot; users per second</span>
<span class="k">And </span><span class="nf">spawn rate is &quot;</span><span class="s">1</span><span class="nf">&quot; user per second</span>
</code></pre></div>
<p><strong>Arguments</strong>:</p>
<ul>
<li><code>spawn_rate</code> <em>int</em> - number of users per second</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../scenario/results/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Results" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Results
            </div>
          </div>
        </a>
      
      
        
        <a href="../../load-users/rest-api/" class="md-footer__link md-footer__link--next" aria-label="Next: Rest API" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Rest API
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.sections"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.409db549.min.js", "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.756773cc.min.js"></script>
      
    
  </body>
</html>